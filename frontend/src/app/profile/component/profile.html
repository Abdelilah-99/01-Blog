<div class="profile-container" *ngIf="profileRes">
    <!-- Profile Header -->
    <div class="profile-header">
        <div class="profile-info">
            <div class="profile-avatar">
                <img *ngIf="profileRes.profileImagePath"
                     [src]="'http://localhost:8080/' + profileRes.profileImagePath"
                     alt="Profile Picture">
                <div *ngIf="!profileRes.profileImagePath" class="avatar-placeholder">
                    {{profileRes.firstName.charAt(0)}}{{profileRes.lastName.charAt(0)}}
                </div>
            </div>
            <div class="profile-details">
                <h1>{{profileRes.firstName}} {{profileRes.lastName}}</h1>
                <p class="username">&#64;{{profileRes.username}}</p>
                <p class="email">{{profileRes.email}}</p>
                <div class="profile-stats">
                    <div class="stat">
                        <span class="stat-value">{{followers}}</span>
                        <span class="stat-label">Followers</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">{{profileRes.following}}</span>
                        <span class="stat-label">Following</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons for Other Users -->
        <div *ngIf="!ifCrrProfile" class="profile-actions">
            <button class="btn btn-follow" *ngIf="!profileRes.connect"
                (click)="followLogic(profileRes.username, profileRes.connect)">
                Follow
            </button>
            <button class="btn btn-unfollow" *ngIf="profileRes.connect"
                (click)="followLogic(profileRes.username, profileRes.connect)">
                Unfollow
            </button>
            <button class="btn btn-report" (click)="onReport()">
                Report
            </button>
        </div>

        <!-- Report Section -->
        <div *ngIf="reportAction" class="report-section">
            <div class="report-header">
                <h3>Report User</h3>
                <button class="close-btn" (click)="onReport()">âœ•</button>
            </div>
            <p class="report-description">Please describe why you're reporting this user. Our team will review your report.</p>
            <div class="report-reasons">
                <label class="reason-option">
                    <input type="radio" name="reportReason" value="spam" #reason1>
                    <span>Spam or misleading</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="reportReason" value="harassment" #reason2>
                    <span>Harassment or bullying</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="reportReason" value="inappropriate" #reason3>
                    <span>Inappropriate content</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="reportReason" value="other" #reason4>
                    <span>Other</span>
                </label>
            </div>
            <textarea name="reportProfile" placeholder="Additional details (optional)..." #reportData></textarea>
            <div class="report-actions">
                <button class="btn btn-cancel" (click)="onReport()">Cancel</button>
                <button class="btn btn-submit"
                    (click)="onSubmitReport(profileRes.uuid, reportData.value); reportData.value=''">
                    <span class="btn-icon">ðŸš¨</span>
                    Submit Report
                </button>
            </div>
        </div>
        <div *ngIf="message" class="message success-message">
            <span class="message-icon">âœ“</span>
            {{message.message}}
        </div>
    </div>

    <!-- User Posts Section -->
    <div class="user-posts-section">
        <h2>Posts</h2>
        <div *ngIf="isLoadingPosts" class="loading">
            Loading posts...
        </div>
        <div *ngIf="!isLoadingPosts && userPosts.length === 0" class="no-posts">
            <p>No posts yet</p>
        </div>
        <div *ngIf="!isLoadingPosts && userPosts.length > 0" class="posts-grid">
            <div *ngFor="let post of userPosts" class="post-card" (click)="navigateToPost(post.postUuid)">
                <!-- Post with image(s) - Image as background with overlay -->
                <div *ngIf="post.mediaPaths && post.mediaPaths.length > 0" class="post-with-image">
                    <div class="post-image-wrapper">
                        <img [src]="'http://localhost:8080/' + post.mediaPaths[0]"
                             alt="{{ post.title }}"
                             class="post-bg-image">
                        <div class="post-image-overlay">
                            <h3 class="post-title-overlay">{{post.title}}</h3>
                        </div>
                    </div>
                    <div class="post-footer-info">
                        <div class="post-author-compact">
                            <div class="author-avatar-small">
                                <img *ngIf="profileRes?.profileImagePath"
                                     [src]="'http://localhost:8080/' + profileRes.profileImagePath"
                                     alt="Profile">
                                <div *ngIf="!profileRes?.profileImagePath" class="avatar-placeholder-small">
                                    {{profileRes.firstName.charAt(0) || ''}}
                                </div>
                            </div>
                            <span class="author-name">{{post.userName}}</span>
                            <span class="post-time">{{post.timestamp}}</span>
                        </div>
                        <div class="post-actions" (click)="$event.stopPropagation()">
                            <button class="action-btn like-btn" (click)="handleLike($event, post.postUuid)">
                                <img src="/coffe-like.png" alt="Like" class="icon">
                                <span>{{post.likeCount}}</span>
                            </button>
                            <button class="action-btn comment-btn" (click)="navigateToPost(post.postUuid)">
                                <img src="/coffe-comment.png" alt="Comment" class="icon">
                                <span class="count">{{post.commentCount}}</span>
                                <span class="text">Comments</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Post without image - Traditional layout -->
                <div *ngIf="!post.mediaPaths || post.mediaPaths.length === 0" class="post-no-image">
                    <div class="post-header">
                        <div class="post-author">
                            <div class="author-avatar-small">
                                <img *ngIf="profileRes?.profileImagePath"
                                     [src]="'http://localhost:8080/' + profileRes.profileImagePath"
                                     alt="Profile">
                                <div *ngIf="!profileRes?.profileImagePath" class="avatar-placeholder-small">
                                    {{profileRes.firstName.charAt(0) || ''}}
                                </div>
                            </div>
                            <div class="author-info">
                                <span class="author-name">{{post.userName}}</span>
                                <span class="post-time">{{post.timestamp}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="post-content">
                        <h3>{{post.title}}</h3>
                        <p>{{post.content}}</p>
                    </div>

                    <div class="post-actions" (click)="$event.stopPropagation()">
                        <button class="action-btn like-btn" (click)="handleLike($event, post.postUuid)">
                            <img src="/coffe-like.png" alt="Like" class="icon">
                            <span>{{post.likeCount}}</span>
                        </button>
                        <button class="action-btn comment-btn" (click)="navigateToPost(post.postUuid)">
                            <img src="/coffe-comment.png" alt="Comment" class="icon">
                            <span class="count">{{post.commentCount}}</span>
                            <span class="text">Comments</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
